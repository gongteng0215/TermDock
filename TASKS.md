# TermDock 任务清单

> 基于 `PRD.md` 拆解。范围分为 `MVP`（必须）与 `V2`（后续）。

## 0. 当前进度（2026-02-11）

状态说明：`DONE` / `PARTIAL` / `TODO`

### 已完成（核心）

- `DONE` `P0-A1` 初始化 Electron + React + TypeScript 工程骨架
- `DONE` `P0-A2` 基础状态联动（会话区 / 终端区 / SFTP 区）
- `DONE` `P0-A4` 安全存储集成（`keytar`，含 fallback）
- `DONE` `P0-B3` 会话删除与二次确认
- `DONE` `P0-C1` xterm 终端基础渲染
- `DONE` `P0-C2` ssh2 连接封装（密码 / 私钥）
- `DONE` `P0-C3` 终端输入输出通道（shell stream）
- `DONE` `P0-C4` 多标签会话管理
- `DONE` `P0-C7` 同一会话多开（同 session 多 tab）
- `DONE` `P0-C8` 终端右键上下文菜单（含 Clear，结构可扩展）

### 部分完成（可用但未达验收）

- `PARTIAL` `P0-A3` 已实现本地持久化 CRUD（JSON），尚未迁移 SQLite / recent_sessions / groups
- `PARTIAL` `P0-B1` 已有会话列表，尚缺分组树与搜索过滤
- `PARTIAL` `P0-B2` 已支持创建表单，尚缺编辑流程
- `PARTIAL` `P0-B5` 已支持收藏标记，尚缺“仅收藏”快速筛选
- `PARTIAL` `P0-C5` 已配置 KeepAlive，尚缺断线重连交互

### 未开始（下一步优先）

- `TODO` `P0-D1 ~ P0-D6` SFTP 全流程
- `TODO` `P0-C6` macOS 快捷键适配
- `TODO` `P0-E1 ~ P0-E4` 稳定性/性能专项
- `TODO` `P0-F1 ~ P0-F4` 测试与发布链路

## 1. 里程碑与范围

| 里程碑 | 周期（建议） | 目标 |
| --- | --- | --- |
| M0 | 2-3 周 | 技术验证：SSH 可连、终端可用、SFTP 基础传输 |
| M1 | 4-6 周 | MVP Alpha：会话管理 + 多标签终端 + SFTP 面板 |
| M2 | 4 周 | Beta：稳定性、性能、日志与错误恢复 |
| M3 | 3-4 周 | GA：macOS 体验打磨 + Windows 11 全面对齐 |

## 2. MVP 任务清单（P0）

### A. 基础架构与工程化

| ID | 任务 | 预估 | 依赖 | 验收标准 |
| --- | --- | --- | --- | --- |
| P0-A1 | 初始化 Electron + React + TypeScript 工程骨架 | 1d | 无 | 可在 macOS/Win11 启动开发版 |
| P0-A2 | 接入状态管理与路由（基础） | 0.5d | P0-A1 | 会话列表、终端区、SFTP 区状态可联动 |
| P0-A3 | 建立 SQLite 数据层（sessions/groups/recent_sessions） | 1d | P0-A1 | 支持 CRUD，迁移脚本可重复执行 |
| P0-A4 | 集成安全存储（macOS Keychain / Windows Credential Manager） | 1d | P0-A1 | 密码与 passphrase 不落明文 |
| P0-A5 | 日志与错误采集基础模块（本地） | 0.5d | P0-A1 | 连接失败、传输失败有结构化日志 |

### B. 会话管理（Session Manager）

| ID | 任务 | 预估 | 依赖 | 验收标准 |
| --- | --- | --- | --- | --- |
| P0-B1 | 会话列表 UI（分组树 + 搜索） | 1d | P0-A2, P0-A3 | 支持按名称/主机过滤 |
| P0-B2 | 会话创建/编辑表单（name/host/port/user/auth） | 1d | P0-A3, P0-A4 | 表单校验完整，保存成功 |
| P0-B3 | 会话删除与二次确认 | 0.5d | P0-B1 | 删除后列表与数据库一致 |
| P0-B4 | 最近使用记录（recent_sessions） | 0.5d | P0-A3 | 成功连接后更新时间戳 |
| P0-B5 | 收藏能力（本地标记） | 0.5d | P0-B1 | 可按“收藏”快速筛选 |

### C. SSH 终端（MVP）

| ID | 任务 | 预估 | 依赖 | 验收标准 |
| --- | --- | --- | --- | --- |
| P0-C1 | 集成 xterm.js 并完成基础渲染 | 1d | P0-A2 | UTF-8 与中文显示正常 |
| P0-C2 | ssh2 连接封装（密码/私钥两种认证） | 1.5d | P0-A4 | 可连接并执行命令 |
| P0-C3 | 终端输入输出通道打通（shell stream） | 1d | P0-C1, P0-C2 | 输入无明显延迟，输出稳定 |
| P0-C4 | 多标签会话管理 | 1d | P0-C3 | 可打开/切换/关闭多个会话 |
| P0-C5 | KeepAlive 与断线提示/手动重连 | 1d | P0-C2 | 断开时有提示且可重连 |
| P0-C6 | macOS 快捷键优先适配（Cmd+T/W/C/V/F） | 0.5d | P0-C4 | 快捷键符合预期语义 |
| P0-C7 | 同一会话多开（同 session 多 tab 实例） | 1d | P0-C4 | 同一会话可并行打开 >= 2 个 tab，输入输出互不干扰 |
| P0-C8 | 终端右键上下文菜单（含 Clear 项） | 0.75d | P0-C1 | 右键可弹出上下文菜单，默认含“清屏”；菜单项可扩展（后续新增项不需重写菜单骨架） |

### D. SFTP 文件管理（MVP）

| ID | 任务 | 预估 | 依赖 | 验收标准 |
| --- | --- | --- | --- | --- |
| P0-D1 | SFTP 通道封装（复用 SSH 连接） | 1d | P0-C2 | 同会话下可列目录 |
| P0-D2 | 右侧文件面板 UI（可折叠） | 1d | P0-A2 | 展开/收起流畅，绑定当前会话 |
| P0-D3 | 文件列表与目录切换 | 1d | P0-D1, P0-D2 | 可进入目录并返回上级 |
| P0-D4 | 上传/下载（进度 + 并发队列） | 1.5d | P0-D3 | 任务可见进度，支持并发 2-4 |
| P0-D5 | 重命名/删除/新建目录/覆盖确认 | 1d | P0-D3 | 高风险操作有确认框 |
| P0-D6 | 拖拽上传（Finder/Explorer） | 1d | P0-D4 | 拖入文件触发上传任务 |

### E. 稳定性、性能与可用性

| ID | 任务 | 预估 | 依赖 | 验收标准 |
| --- | --- | --- | --- | --- |
| P0-E1 | 启动性能优化（冷启动目标 < 3s） | 1d | P0-A1 | macOS 开发机冷启动达标 |
| P0-E2 | 大文件传输内存优化（stream） | 1d | P0-D4 | 上传下载时 UI 不阻塞 |
| P0-E3 | 全局错误提示与可恢复指引 | 0.5d | P0-A5 | 用户可根据提示继续操作 |
| P0-E4 | 数据持久化与异常恢复验证 | 0.5d | P0-A3 | 崩溃后会话数据不丢失 |

### F. 测试与发布（MVP）

| ID | 任务 | 预估 | 依赖 | 验收标准 |
| --- | --- | --- | --- | --- |
| P0-F1 | 单元测试（连接层/数据层） | 1d | P0-C2, P0-A3 | 核心模块测试通过率达标 |
| P0-F2 | 集成测试（SSH + SFTP 核心流程） | 1d | P0-D4 | 首连、上传、下载路径稳定 |
| P0-F3 | 跨平台冒烟测试（macOS/Win11） | 1d | P0 全部 | 两端核心能力无阻塞缺陷 |
| P0-F4 | 打包与安装流程（DMG / EXE） | 1d | P0 全部 | 可安装、可启动、可连接 |

## 3. V2 任务清单（P1）

| ID | 任务 | 预估 | 依赖 | 验收标准 |
| --- | --- | --- | --- | --- |
| P1-1 | 分屏终端（横向/纵向） | 1.5d | P0-C4 | 一个窗口内可多分屏 |
| P1-2 | 命令片段（Snippets）+ 变量 | 2d | P0-A3 | 可保存模板并一键执行 |
| P1-3 | 端口转发 UI（本地转发） | 1.5d | P0-C2 | 可配置、可启停、可持久化 |
| P1-4 | 远程文本文件快速编辑 | 1.5d | P0-D3 | 保存后远程文件更新 |
| P1-5 | 批量执行（多主机同命令） | 2d | P0-B1, P0-C4 | 输出按主机分栏展示 |
| P1-6 | 终端清屏热键（可配置） | 0.5d | P0-C8 | 支持默认热键与用户自定义 |

## 4. 建议执行顺序（可直接开工）

1. 先做 `P0-A`（工程基建 + 数据 + 安全存储）。
2. 并行推进 `P0-B` 与 `P0-C`（会话管理 + SSH 终端，含同会话多开与右键上下文菜单）。
3. 在 `P0-C2` 稳定后推进 `P0-D`（SFTP 全流程）。
4. 收敛到 `P0-E`（性能稳定）与 `P0-F`（测试发布）。
5. MVP 验收后再进入 `P1`（分屏、Snippets、端口转发、清屏热键）。

## 5. MVP 验收检查单

- [ ] 用户可在 3 分钟内完成首次连接并上传/下载文件
- [ ] macOS 与 Windows 11 核心流程测试通过率 >= 95%
- [ ] 连接、传输、认证链路无 P0/P1 阻塞问题
- [ ] 冷启动、终端输入、SFTP 大文件传输达到 PRD 指标
- [ ] 同一会话支持多开且各标签实例运行互不影响
- [ ] 终端支持右键上下文菜单（默认含清屏）且菜单结构可扩展，清屏热键需求进入 P1 规划
