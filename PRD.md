# TermDock PRD

## 1. 文档信息

- 产品名：`TermDock`
- 文档版本：`v1.2`
- 最后更新：`2026-02-15`
- 适用阶段：`MVP(P0)` + `V2(P1)` 规划

## 2. 产品定位

TermDock 是一款面向开发者和运维人员的跨平台桌面 SSH + SFTP 工具。  
目标是用一个窗口完成会话管理、远程终端操作、SFTP 文件传输。

- 主平台：macOS（体验优先）
- 必须兼容：Windows 11

## 3. 目标与非目标

### 3.1 MVP 目标

- 快速、安全连接远程服务器
- 支持稳定的多标签 SSH 终端
- 支持可用的 SFTP 文件浏览与单文件传输
- 降低“终端 + 文件工具”来回切换成本

### 3.2 MVP 非目标

- 不做堡垒机（审批/审计/录像）
- 不做云端账号体系
- 不做移动端

## 4. 目标用户与场景

### 4.1 用户

- 后端/前端开发者
- 运维/SRE
- 需高频 SSH + 文件上传下载的技术用户

### 4.2 典型场景

- 登录测试/生产机排障
- 上传构建产物并执行部署脚本
- 多台机器并行连接查看日志

## 5. 体验原则（硬约束）

- `Compact-first`：默认紧凑布局，优先信息密度
- 操作连贯：会话打开、终端操作、SFTP 切换应在一个工作区内完成
- 降低误操作：危险操作要确认，编辑弹窗默认不允许点空白关闭
- 平台一致性：macOS 使用 `Cmd`，Windows 使用 `Ctrl`

## 6. 功能需求（MVP / P0）

## 6.1 会话管理（Session Manager）

### 需求

- 会话 CRUD
- 会话字段：`name / host / port / username / authType / privateKeyPath / remark / favorite`
- 支持密码与私钥认证
- 支持连接测试
- 支持搜索过滤、收藏筛选、最近连接排序

### 验收要点

- 3 分钟内可创建会话并发起连接
- 编辑/删除后列表与存储一致
- 最近连接时间可回显

## 6.2 SSH 终端（Terminal）

### 需求

- xterm.js 终端渲染
- 多标签、同会话多开
- 右键上下文菜单（MVP 至少含 `Clear`）
- 快捷键：
  - 新标签、关标签
  - 复制/中断、粘贴、搜索
- KeepAlive + 断开后的自动重连（可配置）

### 验收要点

- 输入输出链路稳定
- 多标签互不干扰
- 自动重连可生效并有状态反馈

## 6.3 SFTP 文件管理

### 需求

- 与当前终端标签绑定复用连接
- 目录浏览：进入目录、返回上级、刷新、路径跳转
- 文件操作：新建目录、重命名、删除（MVP 非递归）
- 传输：单文件上传/下载、进度显示、拖拽上传（文件）、上传取消
- 传输状态与目录统计在内容框下方展示，避免列表跳动

### 验收要点

- 能完成“上传文件 -> 下载文件 -> 删除文件”闭环
- 目录切换与列表刷新稳定
- 错误可见并可继续操作
- 上传取消后状态可见，且不应误报失败

## 6.4 设置（Settings）

### 需求

- 可配置自动重连开关与延迟
- 可配置主要快捷键开关
- 平台入口：
  - macOS：应用菜单 `Settings...`（`Command+,`）
  - Windows：`File > Settings...`（`Ctrl+,`）+ 顶栏按钮

### 验收要点

- 设置变更立即生效
- 重启后设置持久化（本地）

## 6.5 安全

### 需求

- 密码/passphrase 不落明文
- macOS 使用 Keychain、Windows 使用 Credential Manager
- 私钥路径可通过系统文件选择器设置

## 7. 非功能需求

- 启动性能：冷启动目标 `< 3s`（开发机基线）
- 稳定性：连接断开可恢复；SFTP 失败有明确错误
- 兼容性：macOS + Windows 11 核心流程可用
- 可用性：关键流程支持键鼠混合操作，减少重复点击

## 8. 技术方案

- 桌面框架：Electron
- 前端：React + TypeScript
- 终端：xterm.js
- SSH/SFTP：ssh2
- 凭据：keytar
- 存储：当前 JSON，后续迁移 SQLite（`sessions/groups/recent_sessions`）

## 9. 数据模型（目标形态）

### sessions

- `id`
- `name`
- `host`
- `port`
- `username`
- `auth_type`
- `private_key_path`
- `group_id`
- `remark`
- `favorite`
- `last_connected_at`

### groups（P1 规划）

- `id`
- `name`
- `parent_id`

### recent_sessions（P1 规划）

- `session_id`
- `last_used_at`

## 10. 版本规划

### v0.1（MVP Preview，可内测）

- 会话管理（CRUD + 搜索/收藏）
- SSH 多标签终端（同会话多开）
- SFTP 基础文件管理与单文件传输
- KeepAlive + 自动重连配置
- 设置页（重连与热键）

### v0.2（Beta）

- SQLite 迁移与分组树
- SFTP 传输队列/并发策略
- 目录拖拽上传与递归操作增强
- 错误恢复与稳定性专项

### v0.3（GA 目标）

- 完整测试与打包发布链路
- 更多效率能力（分屏、Snippets、端口转发）

## 11. 发版准入标准

### 11.1 可发内测（当前已满足）

- 首连、执行命令、上传下载可跑通
- 快捷键、设置、SFTP 主流程可用
- 关键错误可见

### 11.2 可发公开版（当前未满足）

- 完成跨平台冒烟测试（`P0-F3`）
- 完成打包安装流程与签名策略（`P0-F4`）
- 完成全局错误恢复体验（`P0-E3`）

## 12. 当前实现映射（2026-02-15）

- `DONE`：`P0-A1/A2/A4/B3/C1/C2/C3/C4/C6/C7/C8/D1`
- `PARTIAL`：`P0-A3/B1/B2/B4/B5/C5/D2/D3/D4/D5/D6/F4`
- `TODO`：`P0-A5/E1/E2/E3/E4/F1/F2/F3`

结论：当前适合发 `v0.1.0-preview` 内测版，不建议直接公开 GA。

补充：`P0-D4` 已支持上传取消，后续重点为传输队列/并发策略。
